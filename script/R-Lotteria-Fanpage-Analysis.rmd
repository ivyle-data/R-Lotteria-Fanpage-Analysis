---
title: "Lotteria Fanpage Analysis"
output: html_document
date: "2024-03-03"
---

I. Má»¤C TIÃŠU PHÃ‚N TÃCH

Dá»¯ liá»‡u cáº§n Ä‘Æ°á»£c phÃ¢n tÃ­ch lÃ  má»™t táº­p tin Excel ghi láº¡i cÃ¡c bÃ i Ä‘Äƒng vÃ  tÆ°Æ¡ng tÃ¡c trÃªn trang fanpage cá»§a chuá»—i cá»­a hÃ ng Lotteria tá»« nÄƒm 2012 Ä‘áº¿n nÄƒm 2022. Dá»±a vÃ o táº­p tin Ä‘Ã³, nhÃ³m Ä‘Ã£ Ä‘á» xuáº¥t cÃ¡c má»¥c tiÃªu phÃ¢n tÃ­ch nhÆ° sau:

-   Hiá»ƒu rÃµ vá» sá»± phÃ¡t triá»ƒn cá»§a trang fanpage Lotteria tá»« 2012 Ä‘áº¿n 2022.

    Trang fanpage cá»§a Lotteria lÃ  má»™t ná»n táº£ng truyá»n thÃ´ng quan trá»ng giÃºp thÆ°Æ¡ng hiá»‡u tÆ°Æ¡ng tÃ¡c vá»›i khÃ¡ch hÃ ng. Viá»‡c náº¯m báº¯t Ä‘Æ°á»£c sá»± phÃ¡t triá»ƒn cá»§a trang nÃ y tá»« nÄƒm 2012 Ä‘áº¿n 2022 sáº½ cung cáº¥p cÃ¡i nhÃ¬n tá»•ng quan vá» cÃ¡ch mÃ  sá»± hiá»‡n diá»‡n trá»±c tuyáº¿n cá»§a Lotteria Ä‘Ã£ thay Ä‘á»•i vÃ  tiáº¿n triá»ƒn qua cÃ¡c nÄƒm. Äiá»u nÃ y cÃ³ thá»ƒ bao gá»“m táº§n suáº¥t Ä‘Äƒng bÃ i, ná»™i dung baÃ¬ Ä‘Äƒng vÃ  sá»± tÆ°Æ¡ng tÃ¡c tá»« cá»™ng Ä‘á»“ng máº¡ng.

-   ÄÃ¡nh giÃ¡ hiá»‡u suáº¥t bÃ i Ä‘Äƒng dá»±a trÃªn tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng.

    Viá»‡c Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t cá»§a cÃ¡c bÃ i Ä‘Äƒng trÃªn trang fanpage Lotteria dá»±a trÃªn tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng lÃ  má»™t bÆ°á»›c quan trá»ng Ä‘á»ƒ hiá»ƒu Ä‘Æ°á»£c má»©c Ä‘á»™ áº£nh hÆ°á»Ÿng vÃ  sá»± phá»• biáº¿n cá»§a cÃ¡c ná»™i dung Ä‘Æ°á»£c chia sáº». Báº±ng cÃ¡ch phÃ¢n tÃ­ch sá»‘ lÆ°á»£ng like, comment, share vÃ  cÃ¡c hÃ nh Ä‘á»™ng tÆ°Æ¡ng tÃ¡c khÃ¡c, chÃºng ta cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh nhá»¯ng bÃ i Ä‘Äƒng cÃ³ ná»™i dung tháº¿ nÃ o thu hÃºt Ä‘Æ°á»£c sá»± chÃº Ã½ vÃ  tÆ°Æ¡ng tÃ¡c cao nháº¥t tá»« ngÆ°á»i dÃ¹ng.

-   PhÃ¢n tÃ­ch sá»± áº£nh hÆ°á»Ÿng cá»§a xu hÆ°á»›ng vÃ  tá»« khÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c bÃ i Ä‘Äƒng Ä‘áº¿n má»©c Ä‘á»™ tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng.

    Báº±ng cÃ¡ch phÃ¢n tÃ­ch cÃ¡c xu hÆ°á»›ng vÃ  tá»« khÃ³a Ä‘Æ°á»£c dÃ¹ng chá»§ yáº¿u, chÃºng ta cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ Ä‘Æ°á»£c nhá»¯ng tá»« khÃ³a nÃ o cÃ³ thá»ƒ kÃ­ch thÃ­ch sá»± tÆ°Æ¡ng tÃ¡c tá»« phÃ­a ngÆ°á»i dÃ¹ng, bao gá»“m cáº£ sá»‘ lÆ°á»£ng like, comment, share vÃ  cÃ¡c hÃ nh Ä‘á»™ng khÃ¡c. Äiá»u nÃ y giÃºp chÃºng ta hiá»ƒu rÃµ hÆ¡n vá» cÃ¡ch mÃ  Lotteria táº¡o ra ná»™i dung Ä‘á»ƒ thu hÃºt vÃ  tÆ°Æ¡ng tÃ¡c tÃ­ch cá»±c vá»›i cá»™ng Ä‘á»“ng máº¡ng, tá»« Ä‘Ã³ cáº£i thiá»‡n vÃ  tá»‘i Æ°u hÃ³a chiáº¿n lÆ°á»£c truyá»n thÃ´ng.

II. TÃŒM HIá»‚U Dá»® LIá»†U

-   Táº£i packages vÃ  cÃ¡c thÆ° viá»‡n cáº§n dÃ¹ng

```{r}
library(readxl)
library(lubridate)
library(ggplot2)
library(tm)
library(readr)
library(SnowballC)
library(magrittr)
library(tidyverse)
library(scales)
library(igraph)
library(wordcloud)
```

-   Äá»c file data
system("g++ --version")

```{r}
fanpost <- read_excel("fanpost_Lotteria Vietnam_W4.xlsx")
fanpost <- data.frame(fanpost)

stopwords_import <- read.csv('vietnamese-stopwords.txt')
for (i in stopwords_import){
  vietnamese_stopwords <- c(i)
}
```

-   Sá»‘ dÃ²ng, cá»™t vÃ  cáº¥u trÃºc dá»¯ liá»‡u

```{r}
dim(fanpost)
str(fanpost)
```

Data Frame gá»“m 16 cá»™t vÃ  5241 dÃ²ng vá»›i tÃªn cá»™t láº§n lÆ°á»£t lÃ :

| TÃªn cá»™t     | Kiá»ƒu dá»¯ liá»‡u | MÃ´ táº£                 |
|-------------|--------------|-----------------------|
| STT         | num          | Sá»‘ thá»© tá»±             |
| create_time | chr          | Thá»i gian Ä‘Äƒng bÃ i    |
| post_id     | chr          | MÃ£ bÃ i Ä‘Äƒng           |
| message     | chr          | Ná»™i dung bÃ i Ä‘Äƒng     |
| status      | chr          | Tráº¡ng thÃ¡i bÃ i Ä‘Äƒng   |
| comment     | num          | Sá»‘ lÆ°á»£ng bÃ¬nh luáº­n    |
| share       | num          | Sá»‘ lÆ°á»£t chia sáº»       |
| like        | num          | Sá»‘ lÆ°á»£t thÃ­ch         |
| love        | num          | Sá»‘ lÆ°á»£t yÃªu thÃ­ch     |
| haha        | num          | Sá»‘ lÆ°á»£t haha          |
| wow         | num          | Sá»‘ lÆ°á»£t wow           |
| sad         | num          | Sá»‘ lÆ°á»£t buá»“n          |
| angry       | num          | Sá»‘ lÆ°á»£t pháº«n ná»™       |
| thankful    | num          | Sá»‘ lÆ°á»£t biáº¿t Æ¡n       |
| pride       | num          | Sá»‘ lÆ°á»£t tá»± hÃ o        |
| care        | num          | Sá»‘ lÆ°á»£t thÆ°Æ¡ng thÆ°Æ¡ng |

Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu phÃ¢n tÃ­ch Ä‘Ã£ Ä‘á» ra, nhÃ³m Ä‘Ã£ xÃ¡c Ä‘á»‹nh cÃ¡c biáº¿n quan trá»ng cáº§n Ä‘Æ°á»£c sá»­ dá»¥ng trong quÃ¡ trÃ¬nh phÃ¢n tÃ­ch gá»“m "message", "create_time" vÃ  tá»•ng lÆ°á»£t tÆ°Æ¡ng tÃ¡c. Báº±ng cÃ¡ch sá»­ dá»¥ng nhá»¯ng biáº¿n nÃ y, nhÃ³m hy vá»ng cÃ³ thá»ƒ táº¡o ra nhá»¯ng phÃ¢n tÃ­ch sÃ¢u hÆ¡n vÃ  pháº£n Ã¡nh chÃ­nh xÃ¡c hÆ¡n vá» sá»± phÃ¡t triá»ƒn vÃ  hiá»‡u suáº¥t cá»§a trang fanpage Lotteria qua cÃ¡c nÄƒm.

-   GiÃ¡ trá»‹ trá»‘ng (Missing value)

```{r}
# Kiá»ƒm tra giÃ¡ trá»‹ trá»‘ng
colSums(is.na(fanpost))
```

Trong pháº¡m vi thá»i gian phÃ¢n tÃ­ch, biáº¿n "message" cÃ³ 230/5241 giÃ¡ trá»‹ NA (4.39%) vÃ  biáº¿n "status" cÃ³ 85/5241 giÃ¡ trá»‹ NA (1.62%), trong khi cÃ¡c biáº¿n khÃ¡c khÃ´ng cÃ³ giÃ¡ trá»‹ NA. CÃ¡c giÃ¡ trá»‹ NA cá»§a cáº£ hai biáº¿n chá»§ yáº¿u táº­p trung trong khoáº£ng thá»i gian tá»« thÃ¡ng 6/2013 Ä‘áº¿n háº¿t nÄƒm 2015.

á» cÃ¡c dÃ²ng dá»¯ liá»‡u cÃ³ giÃ¡ trá»‹ NA á»Ÿ hai biáº¿n status vÃ  message, cÃ¡c sá»‘ liá»‡u tÆ°Æ¡ng tÃ¡c váº«n Ä‘Æ°á»£c ghi nháº­n. Do Ä‘Ã³, nhÃ³m Ä‘Ã£ ghi nháº­n giÃ¡ trá»‹ NA nhÆ°ng khÃ´ng loáº¡i bá» chÃºng khi phÃ¢n tÃ­ch, nháº±m duy trÃ¬ tÃ­nh toÃ n váº¹n vÃ  chÃ­nh xÃ¡c cá»§a dá»¯ liá»‡u.

-   Äá»•i mÃºi giá»

Äá»ƒ phÃ¹ há»£p vá»›i bá»‘i cáº£nh dá»¯ liá»‡u, nhÃ³m Ä‘Ã£ thá»±c hiá»‡n viá»‡c chuyá»ƒn Ä‘á»•i thá»i gian trong cá»™t "create_time" sang mÃºi giá» Viá»‡t Nam. QuÃ¡ trÃ¬nh nÃ y giÃºp nhÃ³m cÃ³ cÃ¡i nhÃ¬n toÃ n diá»‡n hÆ¡n vá» cÃ¡ch mÃ  cÃ¡c bÃ i Ä‘Äƒng vÃ  hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tÃ¡c thay Ä‘á»•i theo thá»i gian vÃ  trong ngá»¯ cáº£nh Ä‘á»‹a lÃ½ cá»¥ thá»ƒ cá»§a thá»‹ trÆ°á»ng Viá»‡t Nam.

```{r}
# Äá»•i sang mÃºi giá» Viá»‡t Nam
fanpost$create_time <- as.POSIXct(fanpost$create_time, tz = "UTC", "%Y-%m-%dT%H:%M:%OS")
fanpost$create_time_VN <- with_tz(fanpost$create_time, tz = "Asia/Saigon")
```

-   ThÃªm cÃ¡c cá»™t timestamp

Äá»ƒ cÃ³ thá»ƒ phÃ¢n tÃ­ch xu hÆ°á»›ng á»Ÿ cÃ¡c má»‘c thá»i gian khÃ¡c nhau, nhÃ³m Ä‘Ã£ sá»­ dá»¥ng thÆ° viá»‡n lubridate Ä‘á»ƒ tÃ¡ch vÃ  thÃªm cÃ¡c cá»™t má»›i nhÆ° giá», thá»©, ngÃ y, thÃ¡ng, nÄƒm tá»« thá»i gian trong cá»™t "create_timeâ€.

```{r}
# TÃ¡ch thá»i gian
fanpost$Year <- year(fanpost$create_time_VN)
fanpost$Month <- month(fanpost$create_time_VN, label = TRUE)
fanpost$Day <- day(fanpost$create_time_VN)
fanpost$Weekday <-wday(fanpost$create_time_VN, label=TRUE)
fanpost$Hour <- hour(fanpost$create_time_VN)
```

-   TÃ­nh Ä‘iá»ƒm react vÃ  comment

Äá»ƒ phÃ¢n tÃ­ch má»©c Ä‘á»™ tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng, nhÃ³m Ä‘Ã£ tá»•ng há»£p sá»‘ lÆ°á»£t tÆ°Æ¡ng tÃ¡c á»Ÿ cÃ¡c má»¥c riÃªng láº» vá» cáº£m xÃºc (nhÆ° like, love, haha, wow, sad, angry, thankful, pride, care) vÃ  cÃ¡c tÆ°Æ¡ng tÃ¡c khÃ¡c (comment, share) thÃ nh hai biáº¿n má»›i lÃ  "react_score" vÃ  "comment_score".

Biáº¿n "react_score" Ä‘Æ°á»£c tÃ­nh báº±ng tá»•ng sá»‘ lÆ°á»£t tÆ°Æ¡ng tÃ¡c tá»« cÃ¡c cáº£m xÃºc, trong Ä‘Ã³ sá»‘ lÆ°á»£t tÆ°Æ¡ng tÃ¡c vá» cÃ¡c cáº£m xÃºc "sad" vÃ  "angry" lÃ  sá»‘ Ã¢m, pháº£n Ã¡nh sá»± tiÃªu cá»±c cá»§a cá»™ng Ä‘á»“ng máº¡ng Ä‘á»‘i vá»›i bÃ i Ä‘Äƒng. Biáº¿n "comment_score" lÃ  tá»•ng sá»‘ lÆ°á»£t bÃ¬nh luáº­n vÃ  chia sáº».

```{r}
# TÃ­nh Ä‘iá»ƒm react_score
fanpost$react_score <-fanpost$like + fanpost$love + fanpost$haha + fanpost$wow - fanpost$sad - fanpost$angry + fanpost$thankful + fanpost$pride + fanpost$care

# TÃ­nh Ä‘iá»ƒm comment_score
fanpost$comment_score <- fanpost$comment + fanpost$share
```

-   Dá»¯ liá»‡u sau khi thÃªm cÃ¡c cá»™t

```{r}
head(fanpost)
```

III. KhÃ¡m phÃ¡ dá»¯ liá»‡u

-   Thá»‘ng kÃª mÃ´ táº£

```{r}
#Báº£ng thá»‘ng kÃª mÃ´ táº£
summary(fanpost$react_score)
summary(fanpost$comment_score)
```

Tá»« báº£ng thá»‘ng kÃª mÃ´ táº£, cÃ¡c chá»‰ sá»‘ thá»‘ng kÃª cá»§a "react score" Ä‘á»u lá»›n hÆ¡n ráº¥t nhiá»u so vá»›i "comment score", cho tháº¥y ngÆ°á»i dÃ¹ng thÆ°á»ng chuá»™ng tÆ°Æ¡ng tÃ¡c thÃ´ng qua viá»‡c sá»­ dá»¥ng biá»ƒu tÆ°á»£ng cáº£m xÃºc nhiá»u hÆ¡n so vá»›i viá»‡c tÆ°Æ¡ng tÃ¡c báº±ng cÃ¡ch bÃ¬nh luáº­n vÃ  chia sáº». Äiá»u nÃ y cÃ³ thá»ƒ lÃ  do tÃ­nh tiá»‡n lá»£i vÃ  tá»‘c Ä‘á»™ trong viá»‡c truyá»n Ä‘áº¡t Ã½ kiáº¿n hoáº·c cáº£m xÃºc cá»§a há».

```{r}
# PhÃ¢n phá»‘i biáº¿n react_score
hist(fanpost$react_score, main="Histogram of React score")
# PhÃ¢n phá»‘i biáº¿n comment_score
hist(fanpost$comment_score, main="Histogram of React score")
```

Tá»« báº£ng thá»‘ng kÃª mÃ´ táº£ vÃ  biá»ƒu Ä‘á»“ phÃ¢n phá»‘i á»Ÿ cáº£ 2 biáº¿n react_score vÃ  comment_score, giÃ¡ trá»‹ mean Ä‘á»u lá»›n hÆ¡n median vÃ  cÃ¡c giÃ¡ trá»‹ thÆ°á»ng cao Ä‘á»™t biáº¿n táº¡i ná»­a bÃªn trÃ¡i, tháº¥p á»Ÿ ná»­a bÃªn pháº£i cho tháº¥y dá»¯ liá»‡u cáº£ 2 biáº¿n Ä‘á»u lá»‡ch pháº£i (right skewed)

```{r}
# PhÆ°Æ¡ng sai
round(sd(fanpost$react_score),2)
round(sd(fanpost$comment_score),2)
```

BÃªn cáº¡nh Ä‘Ã³, cáº£ hai biáº¿n Ä‘á»u cÃ³ khoáº£ng biáº¿n thiÃªn vÃ  phÆ°Æ¡ng sai lá»›n, tá»©c lÃ  cÃ³ sá»± biáº¿n Ä‘á»™ng Ä‘Ã¡ng ká»ƒ giá»¯a cÃ¡c giÃ¡ trá»‹ dá»¯ liá»‡u. Tuy nhiÃªn, giÃ¡ trá»‹ mean vÃ  tá»© phÃ¢n vá»‹ thá»© ba (75% quan sÃ¡t) láº¡i khÃ¡ nhá» so vá»›i khoáº£ng biáº¿n thiÃªn nÃ y. Äiá»u nÃ y cho tháº¥y dá»¯ liá»‡u cÃ³ thá»ƒ chá»©a nhiá»u Ä‘iá»ƒm dá»¯ liá»‡u báº¥t thÆ°á»ng (giÃ¡ trá»‹ ngoáº¡i lai).

```{r}
# Biá»ƒu Ä‘á»“ Normal Q-Q biáº¿n react_score
qqnorm(fanpost$react_score)
qqline(fanpost$react_score)

# Biá»ƒu Ä‘á»“ Normal Q-Q biáº¿n comment_score
qqnorm(fanpost$comment_score)
qqline(fanpost$comment_score)
```

Káº¿t há»£p vá»›i biá»ƒu Ä‘á»“ Normal Q-Q, cáº£ 2 biáº¿n Ä‘á»u khÃ´ng phÃ¢n bá»‘ Ä‘á»“ng Ä‘á»u gáº§n Ä‘Æ°á»ng xu hÆ°á»›ng vÃ  Ä‘á»u cÃ³ nhiá»u giÃ¡ trá»‹ ngoáº¡i lai vá»›i giÃ¡ trá»‹ lá»›n cáº§n Ä‘Æ°á»£c xem xÃ©t ká»¹ lÆ°á»¡ng trong quÃ¡ trÃ¬nh phÃ¢n tÃ­ch vÃ  Ä‘Ã¡nh giÃ¡.

-   GiÃ¡ trá»‹ ngoáº¡i lai

NhÆ° Ä‘Ã£ nÃªu trÃªn, cáº£ 2 biáº¿n react_score vÃ  comment score phÃ¢n phá»‘i lá»‡ch má»™t cÃ¡ch rÃµ rÃ ng nÃªn nhÃ³m quyáº¿t Ä‘á»‹nh chá»n phÆ°Æ¡ng phÃ¡p IQR Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vÃ  loáº¡i bá» outliers vÃ¬ phÆ°Æ¡ng phÃ¡p nÃ y khÃ´ng phá»¥ thuá»™c vÃ o dáº¡ng phÃ¢n phá»‘i cá»§a dá»¯ liá»‡u.

Do táº­p dá»¯ liá»‡u khÃ´ng lá»›n vÃ  cÃ³ nhiá»u giÃ¡ trá»‹ ngoáº¡i lai vá»›i giÃ¡ trá»‹ ráº¥t cao, Ä‘á»ƒ trÃ¡nh máº¥t mÃ¡t dá»¯ liá»‡u vÃ  Ä‘áº£m báº£o tÃ­nh chÃ­nh xÃ¡c cá»§a quÃ¡ trÃ¬nh phÃ¢n tÃ­ch, nhÃ³m chá»n ghi nháº­n cÃ¡c giÃ¡ trá»‹ ngoáº¡i lai lá»‡ch ráº¥t nhiá»u (extreme outliers) vá»›i k=3.

```{r}
# TÃ¬m outlies báº±ng IQR
react_score <- fanpost$react_score
comment_score <- fanpost$comment_score
# TÃ­nh Q1 vÃ  Q3 cho cáº£ hai cá»™t
Q1_react <- quantile(react_score, 0.25)
Q3_react <- quantile(react_score, 0.75)

Q1_comment <- quantile(comment_score, 0.25)
Q3_comment <- quantile(comment_score, 0.75)

# TÃ­nh IQR cho cáº£ hai cá»™t
IQR_react <- IQR(react_score)
IQR_comment <- IQR(comment_score)

# XÃ¡c Ä‘á»‹nh khoáº£ng giÃ¡ trá»‹ bÃ¬nh thÆ°á»ng cho cáº£ hai cá»™t
k <- 3
lower_bound_react <- Q1_react - k * IQR_react
upper_bound_react <- Q3_react + k * IQR_react

lower_bound_comment <- Q1_comment - k * IQR_comment
upper_bound_comment <- Q3_comment + k * IQR_comment

# XÃ¡c Ä‘á»‹nh outlier cho cáº£ hai cá»™t
outliers_react_low <- react_score[react_score < lower_bound_react]
outliers_react_high <- react_score[react_score > upper_bound_react]

outliers_comment_low <- comment_score[comment_score < lower_bound_comment]
outliers_comment_high <- comment_score[comment_score > upper_bound_comment]

# Hiá»ƒn thá»‹ káº¿t quáº£
print("Outliers in React score (lower)")
print(outliers_react_low)

print("Outliers in React score (higher)")
print(outliers_react_high)

print("Outliers in Comment score (lower)")
print(outliers_comment_low)

print("Outliers in Comment score (higher)")
print(outliers_comment_high)
```

Biáº¿n react_score cÃ³ 307 giÃ¡ trá»‹ ngoáº¡i lai vÃ  biáº¿n comment_score cÃ³ 445 giÃ¡ trá»‹ ngoáº¡i lai Ä‘Æ°á»£c ghi nháº­n.

-   Sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng theo nÄƒm

```{r}
# sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng theo nÄƒm 
p1 <- ggplot(data = fanpost, aes(x = Year)) +
  geom_bar(stat='count',  fill = "lightblue") +
  labs(x = "Year", y = "Number of posts",
       title = "Number of Posts for Each Year") +
  theme_minimal() + scale_x_continuous(breaks = unique(fanpost$Year))

print(p1)
```

Tá»« biá»ƒu Ä‘á»“, cÃ³ thá»ƒ nháº­n tháº¥y ráº±ng sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng nÄƒm 2012 lÃ  cao nháº¥t. Äiá»u nÃ y lÃ  do trong nÄƒm Ä‘Ã³, cÃ¡c bÃ i Ä‘Äƒng chá»§ yáº¿u lÃ  cÃ¡c bÃ i dá»± thi cá»§a cÃ¡c thÃ­ sinh tham gia cÃ¡c cuá»™c thi Ä‘Æ°á»£c tá»• chá»©c bá»Ÿi Lotteria.

Tuy nhiÃªn, tá»« nÄƒm 2012 Ä‘áº¿n 2015, sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng biáº¿n Ä‘á»™ng máº¡nh vÃ  báº¥t thÆ°á»ng. NÄƒm 2012 cÃ³ sá»‘ bÃ i Ä‘Äƒng cao nháº¥t, gáº§n 1000 bÃ i Ä‘Äƒng Ä‘Æ°á»£c ghi nháº­n. Tuy nhiÃªn, trong nhá»¯ng nÄƒm tiáº¿p theo, cÃ³ má»™t sá»± giáº£m Ä‘Ã¡ng ká»ƒ, vá»›i khoáº£ng 100 bÃ i Ä‘Äƒng vÃ o nÄƒm 2013, khoáº£ng 50 bÃ i vÃ o nÄƒm 2014 vÃ  chá»‰ cÃ³ 2 bÃ i Ä‘Æ°á»£c ghi nháº­n vÃ o nÄƒm 2015.

Tá»« giai Ä‘oáº¡n 2016 Ä‘áº¿n 2022, sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng Ä‘Ã£ á»•n Ä‘á»‹nh vÃ  cÃ³ xu hÆ°á»›ng giáº£m dáº§n. Máº·c dÃ¹ váº«n cÃ³ sá»± biáº¿n Ä‘á»™ng trong sá»‘ liá»‡u, nhÆ°ng nÃ³ khÃ´ng cÃ²n quÃ¡ Ä‘Ã¡ng ká»ƒ nhÆ° trong giai Ä‘oáº¡n trÆ°á»›c Ä‘Ã³.

-   Sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng theo giá»

```{r}
# Sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng theo giá»
p2 <- ggplot(data = fanpost, aes(x = Hour)) +
  geom_bar(stat='count', fill="lightblue") +
  labs(x = "Hour", y = "Number of posts",
       title = "Number of Posts for Each Hour") +
  theme_minimal() + scale_x_continuous(breaks = unique(fanpost$Hour))

print(p2)
```

CÃ¡c bÃ i Ä‘Äƒng thÆ°á»ng Ä‘Æ°á»£c Ä‘Äƒng vÃ o cÃ¡c khoáº£ng thá»i gian tá»« 9 Ä‘áº¿n 12 giá», 14 Ä‘áº¿n 17 giá». ÄÃ¢y cÅ©ng lÃ  nhá»¯ng khoáº£ng thá»i gian tá»‘t nháº¥t Ä‘á»ƒ Ä‘Äƒng bÃ i. (Theo: Sprout Social)

-   Sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng theo thá»©

```{r}
p3 <- ggplot(data = fanpost, aes(x = Weekday)) +
  geom_bar(stat='count',  fill="lightblue") +
  labs(x = "Weekday", y = "Number of posts",
       title = "Barplot of Number of Posts for Each Weekday") +
  theme_minimal()

print(p3)
```

CÃ¡c bÃ i Ä‘Äƒng Ä‘Æ°á»£c Ä‘Äƒng nhiá»u hÆ¡n vÃ o cÃ¡c ngÃ y trong tuáº§n, vá»›i sá»‘ lÆ°á»£ng cao nháº¥t vÃ o thá»© SÃ¡u, trong khi cÃ³ sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng tháº¥p hÆ¡n nhiá»u vÃ o 2 ngÃ y cuá»‘i tuáº§n.

-   Tá»‘ng tÆ°Æ¡ng tÃ¡c

```{r}
fanpost$total <- fanpost$react_score+fanpost$comment_score
```

-   Tá»•ng tÆ°Æ¡ng tÃ¡c theo nÄƒm

```{r}
average_total_score_yearly <- aggregate(fanpost$total, by= list(fanpost$Year),FUN = mean)

p4 <- ggplot(data = average_total_score_yearly, aes(x = Group.1, y= x)) +
  geom_bar(stat='identity', fill="lightblue") +
  labs(x = "Year", y = "Average of Total React Score",
       title = "Average of Total React Score per Year") +
  theme_minimal() + scale_x_continuous(breaks = unique(average_total_score_yearly$Group.1))

print(p4)
```

Máº·c dÃ¹ nÄƒm 2012 cÃ³ sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng cao nháº¥t nhÆ°ng sá»‘ lÆ°á»£t tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng láº¡i tháº¥p hÆ¡n ráº¥t nhiá»u so vá»›i cÃ¡c nÄƒm khÃ¡c. Äiá»u nÃ y cÃ³ thá»ƒ lÃ  do cÃ¡c bÃ i Ä‘Äƒng chá»§ yáº¿u lÃ  bÃ i dá»± thi cá»§a thÃ­ sinh nhÆ° Ä‘Ã£ nÃ³i trÃªn nÃªn khÃ´ng quÃ¡ thu hÃºt sá»± quan tÃ¢m cá»§a Ä‘a sá»‘ ngÆ°á»i dÃ¹ng.

Trong khi Ä‘Ã³, sá»‘ lÆ°á»£t tÆ°Æ¡ng tÃ¡c cÃ³ xu hÆ°á»›ng tÄƒng trong giai Ä‘oáº¡n tá»« 2018 Ä‘áº¿n 2022, máº·c dÃ¹ sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng giáº£m dáº§n cho tháº¥y hiá»‡u quáº£ tÆ°Æ¡ng tÃ¡c ngÃ y cÃ ng cao hÆ¡n á»Ÿ má»—i bÃ i Ä‘Äƒng, Ä‘á»“ng thá»i cho tháº¥y sá»± chÃº Ã½ vÃ  tÆ°Æ¡ng tÃ¡c tÃ­ch cá»±c cá»§a cá»™ng Ä‘á»“ng ngÆ°á»i dÃ¹ng trong thá»i gian nÃ y.

NgoÃ i ra, bÃªn cáº¡nh sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng, sá»‘ lÆ°á»£t tÆ°Æ¡ng tÃ¡c cÅ©ng á»•n Ä‘á»‹nh hÆ¡n tá»« nÄƒm 2016 Ä‘áº¿n nÄƒm 2022. VÃ¬ tháº¿, Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh tá»•ng quáº¥t trong cÃ¡c phÃ¢n tÃ­ch sÃ¢u hÆ¡n tiáº¿p theo, nhÃ³m sáº½ phÃ¢n tÃ­ch chá»§ yáº¿u cÃ¡c sá»‘ liá»‡u tá»« nÄƒm 2016.

Tá»•ng tÆ°Æ¡ng tÃ¡c theo giá»

```{r}
average_total_score_hourly <- aggregate(fanpost$total, by= list(fanpost$Hour),FUN = mean)

p5 <- ggplot(data = average_total_score_hourly, aes(x = Group.1, y= x)) +
  geom_bar(stat='identity', fill="lightblue") +
  labs(x = "Hour", y = "Average of Total React Score",
       title = "Average of Total React Score per Hour") +
  theme_minimal() + scale_x_continuous(breaks = unique(average_total_score_hourly$Group.1))

print(p5)
```

CÃ³ sá»± cao báº¥t thÆ°á»ng á»Ÿ sá»‘ lÆ°á»£t tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng vÃ o 1 giá» do cÃ³ má»™t giÃ¡ trá»‹ ngoáº¡i lai vá»›i sá»‘ lÆ°á»£t like cao hÆ¡n háº³n (12071 lÆ°á»£t) so vá»›i cÃ¡c bÃ i Ä‘Äƒng cÃ²n láº¡i, khiáº¿n cho giÃ¡ trá»‹ trung bÃ¬nh lÆ°á»£t tÆ°Æ¡ng tÃ¡c vÃ o 1 giá» cÅ©ng cao hÆ¡n háº³n cÃ¡c giá» khÃ¡c.

```{r}
# Biáº¿n dá»¯ liá»‡u thÃ nh Corpus
fanpostCorpus <- Corpus(VectorSource(fanpost$message))
```

```{r}
# Transform dá»¯ liá»‡u
fanpostCorpus <- tm_map(fanpostCorpus, content_transformer(tolower)) # Viáº¿t thÆ°á»ng
fanpostCorpus <- tm_map(fanpostCorpus, removePunctuation) # Bá» dáº¥u
fanpostCorpus <- tm_map(fanpostCorpus, removeNumbers) # Bá» nhá»¯ng con sá»‘
fanpostCorpus <- tm_map(fanpostCorpus, removeWords, vietnamese_stopwords) # Bá» stopwords
fanpostCorpus <- tm_map(fanpostCorpus, stripWhitespace) # Bá» khoáº£ng tráº¯ng
fanpostCorpus <- tm_map(fanpostCorpus, stemDocument) # Stemming
```

```{r}
# Táº¡o Term Document matrix
fanpostTDM <- TermDocumentMatrix(fanpostCorpus, control = list(wordLenghts=c(1,Inf)))
fanpostTDM <- removeSparseTerms(fanpostTDM, 0.9)
fanpostTDM <- as.matrix(fanpostTDM)
```

```{r}
#TÃ¬m cÃ¡c tá»« phá»• biáº¿n nháº¥t
freq <-rowSums(fanpostTDM)

print(freq)
barplot(freq, las=2, col=rainbow(50), cex.names = 0.4)
```
Tá»« káº¿t quáº£ trÃªn cho tháº¥y má»™t sá»‘ tá»« cÃ³ táº§n suáº¥t xuáº¥t hiá»‡n nhiá»u nháº¥t nhÆ°: lotteria, hÃ ng, cá»­a,... 
Tiáº¿p theo, nhÃ³m thá»±c hiá»‡n bÆ°á»›c tÃ¬m tá»•ng sá»‘ dÃ²ng mÃ  má»—i tá»« trÃªn xuáº¥t hiá»‡n (tá»©c sá»‘ message cÃ³ cÃ¡c tá»« trÃªn) Ä‘á»ƒ tÃ¬m nhá»¯ng tá»« cÃ³ táº§n suáº¥t xuáº¥t hiá»‡n nhiá»u nháº¥t trong táº¥t cáº£ cÃ¡c bÃ i Ä‘Äƒng.
```{r}
# TÃ­nh tá»•ng sá»‘ dÃ²ng mÃ  má»—i tá»« trÃªn xuáº¥t hiá»‡n (tá»©c sá»‘ message cÃ³ cÃ¡c tá»« trÃªn)
num_docs_with_word <- rowSums(as.matrix(fanpostTDM) > 0)

# Hiá»ƒn thá»‹ káº¿t quáº£
print(num_docs_with_word)
barplot(num_docs_with_word, las=2, col=rainbow(50), cex.names = 0.4)
```
Dá»±a trÃªn káº¿t quáº£ phÃ¢n tÃ­ch táº§n suáº¥t xuáº¥t hiá»‡n cá»§a tá»«ng tá»« trong cÃ¡c bÃ i Ä‘Äƒng, chÃºng ta cÃ³ thá»ƒ nháº­n tháº¥y má»™t sá»‘ tá»« Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u nháº¥t nhÆ° "lotteria", "hÃ ng", "cá»­a", vÃ  "gÃ ". Tuy nhiÃªn, khi káº¿t há»£p cáº£ hai káº¿t quáº£ trÃªn, ta nháº­n tháº¥y má»™t sá»‘ tá»« xuáº¥t hiá»‡n nhiá»u láº§n khÃ´ng chá»‰ trong má»™t sá»‘ bÃ i Ä‘Äƒng mÃ  cÃ²n trong nhiá»u bÃ i Ä‘Äƒng khÃ¡c nhau. VÃ­ dá»¥, tá»« "lotteria" thÆ°á»ng xuáº¥t hiá»‡n trong hashtag á»Ÿ cuá»‘i má»—i bÃ i Ä‘Äƒng vÃ  trong ná»™i dung cá»§a bÃ i Ä‘Äƒng, cÃ³ thá»ƒ tháº¥y sá»± xuáº¥t hiá»‡n dÃ y Ä‘áº·c lÃ  cÃ¡ch Ä‘á»ƒ thÆ°Æ¡ng hiá»‡u "lotteria" Ä‘Æ°á»£c nháº­n diá»‡n bá»Ÿi ngÆ°á»i dÃ¹ng. Äi kÃ¨m vá»›i "lotteria", cÃ²n cÃ³ tá»« "lotteriavietnam".
Äá»ƒ tÃ¬m hiá»ƒu sÃ¢u hÆ¡n vá» cÃ¡c nhÃ³m tá»« mang tÃ­nh Ä‘áº·c trÆ°ng cá»§a tá»«ng bÃ i Ä‘Äƒng, nhÃ³m quyáº¿t Ä‘á»‹nh loáº¡i bá» nhá»¯ng tá»« chung chung xuáº¥t hiá»‡n nhiá»u láº§n nhÆ° "lotteria" vÃ  "lotteriavietnam". NgoÃ i ra, tá»« "hÃ ng" cÅ©ng lÃ  má»™t tá»« Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u thá»© hai, thÆ°á»ng káº¿t há»£p vá»›i tá»« "cá»­a" Ä‘á»ƒ táº¡o thÃ nh cá»¥m tá»« "cá»­a hÃ ng". Do Ä‘Ã³, nhÃ³m quyáº¿t Ä‘á»‹nh loáº¡i bá» tá»« "cá»­a hÃ ng" khá»i danh sÃ¡ch cÃ¡c tá»« Ä‘á»ƒ táº­p trung vÃ o nhá»¯ng tá»« mang tÃ­nh Ä‘áº·c trÆ°ng vÃ  cá»¥ thá»ƒ hÆ¡n cá»§a tá»«ng bÃ i Ä‘Äƒng.
```{r}
sorted_freq <- sort(freq, decreasing = TRUE)
print(sorted_freq)
```

```{r}
# Loáº¡i bá» tá»« Ä‘Æ¡n, tá»« ghÃ©p thÆ°á»ng xuáº¥t hiá»‡n: "lotteria", "lotteriavietnam", "cá»­a hÃ ng",... khá»i fanpostCorpus

# Danh sÃ¡ch cÃ¡c tá»« cáº§n loáº¡i bá»
words_to_remove <- c("lotteria", "cá»­a hÃ ng", "lotteriavietnam")

# Loáº¡i bá» cÃ¡c tá»« khá»i má»—i tÃ i liá»‡u trong fanpostCorpus
fanpostCorpus <- lapply(fanpostCorpus, function(doc) {
  for (word in words_to_remove) {
    doc <- gsub(word, "", doc)
  }
  return(doc)
})

# Chuyá»ƒn Ä‘á»•i fanpostCorpus thÃ nh dataframe
fanpostData <- data.frame(text = sapply(fanpostCorpus, as.character), stringsAsFactors = FALSE)

# In ra má»™t sá»‘ dÃ²ng Ä‘áº§u cá»§a dataframe má»›i
head(fanpostData)
```
Sau khi cÃ³ data cá»§a message má»›i Ä‘Ã£ loáº¡i bá» cÃ¡c yáº¿u tá»‘ trÃªn, thÃªm cá»™t má»›i cÃ³ tÃªn lÃ  new_mesage vÃ o dataset fanpost Ä‘á»ƒ tiáº¿p tá»¥c phÃ¢n tÃ­ch cÃ¡c nhÃ³m tá»« cÃ³ Ä‘áº·c trÆ°ng rÃµ rÃ ng hÆ¡n.
```{r}
# ThÃªm cá»™t má»›i tá»« fanpostData vÃ o fanpost
fanpost$new_message <- fanpostData$text

# In káº¿t quáº£
head(fanpost)
```
NhÃ³m tiáº¿n hÃ nh phÃ¢n tÃ­ch Ä‘á»™ dÃ i trung bÃ¬nh cá»§a cÃ¡c bÃ i viáº¿t theo nÄƒm, sau Ä‘Ã³ so sÃ¡nh vá»›i lÆ°á»£ng tÆ°Æ¡ng tÃ¡c trung bÃ¬nh nháº±m kiá»ƒm tra sá»± áº£nh hÆ°á»Ÿng cá»§a chiá»u dÃ i bÃ i viáº¿t tá»›i Ä‘á»™ tÆ°Æ¡ng tÃ¡c.

```{r}
# PhÃ¢n cá»¥m
positive <- subset(fanpost, react_score > 411)
negative <- subset(fanpost, react_score < 60)
neutral <- subset(fanpost, react_score >= 60 & react_score <= 411)
```
Sau Ä‘Ã³, dá»±a trÃªn react_score phÃ¢n thÃ nh 3 cá»¥m gá»“m: positive, negative vÃ  neutral.
-   PhÃ¢n tÃ­ch dÃ²ng
```{r}
#TÃ­nh chiá»u dÃ i cá»§a tá»«ng dÃ²ng message
fanpostData$text_length <- nchar(fanpostData$text)
fanpostData
```
Theo káº¿t quáº£ trÃªn so sÃ¡nh vá»›i biá»ƒu Ä‘á»“ trung bÃ¬nh react theo nÄƒm, cÃ³ thá»ƒ tháº¥y Ã­t sá»± tÆ°Æ¡ng quan vá» áº£nh hÆ°á»Ÿng cá»§a Ä‘á»™ dÃ i bÃ i viáº¿t tá»›i Ä‘á»™ tÆ°Æ¡ng. VÃ¬ váº­y, nhÃ³m chuyá»ƒn sang hÆ°á»›ng chia cá»¥m dá»±a trÃªn Ä‘iá»ƒm tÆ°Æ¡ng tÃ¡c.
NhÃ³m tiáº¿n hÃ nh tÃ­nh Ä‘iá»ƒm tÆ°Æ¡ng tÃ¡c qua cÃ´ng thá»©c: react_score = like + love + haha + wow - sad - angry + thankful + care.
TÃ­nh Ä‘iá»ƒm comment = comment + share
```{r}
# ThÃªm cá»™t má»›i tá»« fanpostData vÃ o fanpost
fanpostData$Year <- fanpost$Year

# In káº¿t quáº£
head(fanpostData)
```

```{r}
# TÃ­nh trung bÃ¬nh tá»•ng sá»‘ tá»« cá»§a cá»™t fanpostData qua tá»«ng nÄƒm
average_word_count_by_year <- aggregate(fanpostData$text_length, by=list(fanpostData$Year), FUN = mean)

# In káº¿t quáº£
print(average_word_count_by_year)
```

4.2. PhÃ¢n tÃ­ch cá»¥ thá»ƒ tá»«ng cá»¥m

- PhÃ¢n tÃ­ch cá»¥m Positive



-   Kiá»ƒm tra dá»¯ liá»‡u

```{r, warning = FALSE}
# Kiá»ƒm tra data 
dim(positive)
# Äáº¿m missing values
sum(is.na(positive))
```

Kiá»ƒm tra cá»¥m positive cÃ³ 10 dÃ²ng chá»©a giÃ¡ trá»‹ NA trÃªn tá»•ng 1309 dÃ²ng; chiáº¿m 0,007%. - Xá»­ lÃ½ dá»¯ liá»‡u

```{r, warning = FALSE}
# Táº¡o corpus cho cá»¥m positive
positiveMessage <- positive$new_message
positiveCorpus <- Corpus(VectorSource(positiveMessage))

# ThÃªm thÃ´ng tin nÄƒm cho positiveCorpus
meta(positiveCorpus, tag = "Create_Year") <- positive$Year
```

-   Táº¡o TDM

```{r, warning = FALSE}
# Táº¡o TDM cho cá»¥m positive
positiveTDM <- TermDocumentMatrix(positiveCorpus, control = list(wordLenghts=c(1,Inf)))
positiveTDM <- removeSparseTerms(positiveTDM, 0.9)
inspect(positiveTDM)
dim(positiveTDM)

```

Chá»n ngÆ°á»¡ng tuáº§n suáº¥t tá»‘i thiá»ƒu lÃ  0.9, nháº­n Ä‘Æ°á»£c 102 tá»« Ä‘Æ¡n. Vá»›i Ä‘oáº¡n máº«u hiá»ƒn thá»‹ cá»§a Term Document Matrix, cÃ³ thá»ƒ nháº­n tháº¥y cÃ¡c chá»¯ Ä‘á»u cÃ³ nghÄ©a, nhÃ³m dá»± Ä‘oÃ¡n cÃ¡c tá»« Ä‘Æ¡n nÃ y thuá»™c tá»« ghÃ©p vÃ  theo xu hÆ°á»›ng, chá»§ Ä‘á» nÃ o Ä‘Ã³.

-   XÃ¡c Ä‘á»‹nh tá»« khÃ³a phá»• biáº¿n

```{r, warning = FALSE}
# XÃ¡c Ä‘á»‹nh tá»« khÃ³a phá»• biáº¿n
term_freq <- rowSums(as.matrix(positiveTDM))
top_keywords <- head(sort(term_freq, decreasing = TRUE), 20)
print(top_keywords)


```

Danh sÃ¡ch 20 tá»« Ä‘Æ¡n Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u nháº¥t trong cá»¥m positive Ä‘á»u lÃ  tá»« Ä‘Æ¡n cÃ³ nghÄ©a.

-   Kiá»ƒm tra Ä‘á»™ tÆ°Æ¡ng quan giá»¯a cÃ¡c tá»« Ä‘Æ¡n

```{r, warning = FALSE}
# Láº¥y danh sÃ¡ch cÃ¡c tá»« khÃ³a
keywords <- names(top_keywords)

# Táº¡o ma tráº­n chá»©a thÃ´ng tin vá» sá»± xuáº¥t hiá»‡n cá»§a tá»«ng tá»« khÃ³a trong má»—i bÃ i viáº¿t positive
keyword_matrix <- sapply(keywords, function(keyword) grepl(keyword, positive$new_message, ignore.case = TRUE))

# TÃ­nh ma tráº­n tÆ°Æ¡ng quan giá»¯a cÃ¡c tá»« khÃ³a
correlation_matrix <- cor(keyword_matrix)

# In ma tráº­n tÆ°Æ¡ng quan
print(correlation_matrix)

# Váº½ biá»ƒu Ä‘á»“ nhiá»‡t tÆ°Æ¡ng quan
heatmap(correlation_matrix, 
        col = colorRampPalette(c("white", "blue"))(20),
        main = "Biá»ƒu Ä‘á»“ nhiá»‡t tÆ°Æ¡ng quan giá»¯a cÃ¡c tá»« khÃ³a trong bÃ i viáº¿t positive")

# Váº½ biá»ƒu Ä‘á»“ máº¡ng cÃ¡c tá»« khÃ³a cÃ³ giÃ¡ trá»‹ tÆ°Æ¡ng quan hÆ¡n 0.5
library(igraph)
keyword_network <- graph.adjacency(correlation_matrix > 0.5, mode = "undirected")
plot(keyword_network, main = "Biá»ƒu Äá»“ Máº¡ng TÆ°Æ¡ng Quan Tá»« KhÃ³a trong BÃ i Viáº¿t Positive")

```

Ma tráº­n tÆ°Æ¡ng quan thá»ƒ hiá»‡n giÃ¡ trá»‹ tÆ°Æ¡ng quan cá»§a 20 tá»« khÃ³a ná»•i báº­t, Ä‘á»ƒ trá»±c quan rÃµ hÆ¡n, nhÃ³m sá»­ dá»¥ng biá»ƒu Ä‘á»“ nhiá»‡t thá»ƒ hiá»‡n sá»­ tÆ°Æ¡ng quan cho ma tráº­n 20 tá»« khÃ³a vÃ  biá»ƒu Ä‘á»“ máº¡ng tÆ°Æ¡ng quan Ä‘á»ƒ trá»±c quan nhá»¯ng má»‘i quan há»‡ tÆ°Æ¡ng quan lá»›n hÆ¡n 0,5. Äá»‘i vá»›i biá»ƒu Ä‘á»“ nhiá»‡t, cÃ³ thá»ƒ dá»… nhÃ¬n rÃµ hÆ¡n ráº±ng 20 tá»« Ä‘Æ¡n nÃ y cÃ³ liÃªn quan nhiá»u Ä‘áº¿n nhau vÃ¬ cÃ³ ráº¥t nhiá»u cá»¥m mÃ u Ä‘áº­m vÃ  Ã­t cá»¥m mÃ u tráº¯ng. Biá»ƒu Ä‘á»“ máº¡ng tÆ°Æ¡ng quan thá»ƒ hiá»‡n sÃ¢u hÆ¡n cÃ¡c cá»¥m chá»¯ thÆ°á»ng Ä‘i liá»n vá»›i nhau, cho tháº¥y 2 chá»§ Ä‘á» mÃ  bÃ i viáº¿t cÃ³ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c cao: ChÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i (vá»›i tá»« khÃ³a lÃ : combo, khoai tÃ¢y, gÃ  rÃ¡n, pepsi, chÆ°Æ¡ng trÃ¬nh, khuyáº¿n mÃ£i, Ã¡p dá»¥ng, giao hÃ ng...) vÃ  Cuá»™c thi (vá»›i tá»« khÃ³a lÃ : dá»± thi, giáº£i, hÃ¬nh, comment, bÃ¬nh luáº­n,...).

-   Kiá»ƒm tra vá» lÆ°á»£ng tÆ°Æ¡ng tÃ¡c tÃ­ch cá»±c theo thá»i gian vÃ  Ä‘á»™ dÃ i caption

```{r}
# Kiá»ƒm tra tÆ°Æ¡ng tÃ¡c tÃ­ch cá»±c theo Ä‘á»™ dÃ i cÃ¢u
positive$word_count <- sapply(strsplit(positive$message, "\\s+"), length)
ggplot(positive, aes(x = word_count, y = react_score)) +
  geom_point() +
  geom_smooth() +
  labs(title = "TÆ°Æ¡ng tÃ¡c tÃ­ch cá»±c theo Ä‘á»™ dÃ i cÃ¢u")
```

Äá»™ dÃ i cÃ¢u thÆ°á»ng tá»« dÆ°á»›i 500 tá»« Ä‘Æ¡n, vÃ  cÃ¡c bÃ i viáº¿t Ä‘Æ°á»£c tÆ°Æ¡ng tÃ¡c tÃ­ch cá»±c náº±m pháº§n lá»›n á»Ÿ khoáº£ng nÃ y.

-   Kiá»ƒm tra thá»i gian fanpage Ä‘Äƒng cÃ¡c bÃ i viáº¿t Ä‘Æ°á»£c tÆ°Æ¡ng tÃ¡c tÃ­ch cá»±c

```{r}
# Táº¡o biáº¿n thá»i gian
positive$hour <- format(positive$create_time_VN, format = "%H")

# Táº¡o biá»ƒu Ä‘á»“
ggplot(positive, aes(x = hour)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "PhÃ¢n phá»‘i thá»i gian Ä‘Äƒng bÃ i tÃ­ch cá»±c",
       x = "Giá»",
       y = "Sá»‘ lÆ°á»£ng bÃ i viáº¿t") +
  theme_minimal()
```

CÃ¡c bÃ i viáº¿t nháº­n Ä‘Æ°á»£c tÆ°Æ¡ng tÃ¡c cao thÆ°á»ng Ä‘Æ°á»£c Ä‘Äƒng táº£i vÃ o 2 khung giá»: 9 giá» Ä‘áº¿n 11 giá» sÃ¡ng, 14 giá» Ä‘áº¿n 16 giá» chiá»u. ÄÃ¢y lÃ  2 khung giá» trÆ°á»›c bá»¯a trÆ°a vÃ  bá»¯a tá»‘i, thÃ­ch há»£p Ä‘á»ƒ Ä‘Äƒng cÃ¡c bÃ i truyá»n thÃ´ng khuyáº¿n mÃ£i, combo, giao hÃ ng, tÆ°Æ¡ng thÃ­ch vá»›i nhá»¯ng tá»« khÃ³a Ä‘Ã£ phÃ¢n tÃ­ch trÆ°á»›c Ä‘Ã³. Äáº·c biá»‡t, khung 10 giá» Ä‘áº¿n 11 giá» cÃ³ sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng cao nháº¥t, cÃ³ thá»ƒ vÃ¬ khung giá» nÃ y phÃ¹ há»£p Ä‘á»ƒ Ä‘á»ƒ truyá»n thÃ´ng cho cÃ¡c bá»™ pháº­n dÃ¢n vÄƒn phÃ²ng, sinh viÃªn dÃ¹ng bá»¯a trÆ°a bÃªn ngoÃ i nhiá»u hÆ¡n so vá»›i bá»¯a tá»‘i. NgoÃ i ra, cÃ¡c khung giá» 19 giá» Ä‘áº¿n 21 giá» cÅ©ng cÃ³ sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng tÆ°Æ¡ng Ä‘á»‘i, vÃ¬ Ä‘Ã¢y lÃ  thá»i gian nghá»‰ ngÆ¡i cuá»‘i ngÃ y, vÃ  cÅ©ng dáº«n Ä‘áº¿n khung giá» hiáº¿m khi Ä‘Äƒng bÃ i trÃªn fanpage lÃ  tá»« 23 giá» Ä‘áº¿n 7 giá» sÃ¡ng.

## Pháº§n cá»¥m Neutral

Pháº§n preprocessing

```{r, warning=FALSE}
# Biáº¿n dá»¯ liá»‡u thÃ nh Corpus
neutralMessage <- neutral$new_message
neutralCorpus <- Corpus(VectorSource(neutralMessage))

# ThÃªm metadata
meta(neutralCorpus, tag = "id") <- neutral$post_id
meta(neutralCorpus, tag = "create_Year") <- neutral$Year
meta(neutralCorpus, tag = "status") <- neutral$status
meta(neutralCorpus, tag = "React_score") <- neutral$react_score
meta(neutralCorpus, tag = "comment_score") <- neutral$comment_score

# Transform dá»¯ liá»‡u
neutralCorpus <- tm_map(neutralCorpus, content_transformer(tolower)) # Viáº¿t thÆ°á»ng
neutralCorpus <- tm_map(neutralCorpus, removePunctuation) # Bá» dáº¥u
neutralCorpus <- tm_map(neutralCorpus, removeNumbers) # Bá» nhá»¯ng con sá»‘
neutralCorpus <- tm_map(neutralCorpus, removeWords, stopwords) # Bá» stopwords
neutralCorpus <- tm_map(neutralCorpus, stripWhitespace) # Bá» khoáº£ng tráº¯ng
neutralCorpus <- tm_map(neutralCorpus, stemDocument) # Stemming
```

### Táº¡o TDM
```{r, warning=FALSE}
# Create the Term Document Matrix
neutralTDM <- TermDocumentMatrix(neutralCorpus, control = list(wordLengths = c(1, Inf)))
neutralTDM <- removeSparseTerms(neutralTDM, 0.9)

# Examine the TDM
inspect(neutralTDM)
```
## Insight
Vá»›i Ä‘á»™ sparse táº§m 80%, káº¿t quáº£ cho tháº¥y sá»± phÃ¢n bá»• cá»§a cÃ¡c tá»« khÃ¡ lÃ  Ä‘á»u, khÃ´ng cÃ³ tá»« nÃ o quÃ¡ ná»•i báº­t vÃ  Ä‘a sá»‘ Ä‘Æ°á»£c dÃ¹ng trong má»i bÃ i Ä‘Äƒng. Tá»« "gÃ ", "hÃ ng", "giao" xuáº¥t hiá»‡n vá»›i táº§n suáº¥t cao. Cho tháº¥y cÃ¡c tá»« Ä‘Æ°á»£c sá»­ dÃ¹ng nhiá»u láº§n trong má»™t bÃ i Ä‘Äƒng cá»¥ thá»ƒ.

## TÃ¬m nhá»¯ng tá»« phá»• biáº¿n nháº¥t
```{r}
# Find the most frequent terms
term_freq <- rowSums(as.matrix(neutralTDM))
term_freq <- sort(term_freq, decreasing = TRUE)
head(term_freq, 20) # Display the top 20 most frequent terms
```
## Insight
ÄÃºng vá»›i nháº­n xÃ©t trÃªn, cÃ¡c tá»« Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u nháº¥t lÃ  'gÃ ', 'hÃ ng',... Tuy nhiÃªn, cÃ³ vÃ i tá»« khÃ´ng cÃ³ nghÄ©a xuáº¥t hiá»‡n á»Ÿ trÃªn káº¿t quáº£ nhÆ° 'k', 'd', 'm'; Hiá»‡n tÆ°á»£ng nÃ y xáº£y ra lÃ  do trong quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ dá»¯ liá»‡u Ä‘Ã£ bá» máº¥t context. VÃ­ dá»¥ giÃ¡ tiá»n thÆ°á»ng Ä‘Æ°á»£c ghi lÃ  '39k', '4000d', trong quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ Ä‘Ã£ bá» máº¥t nhá»¯ng con sá»‘ bá» láº¡i cÃ¡c kÃ½ tá»±. CÃ³ thá»ƒ xem cÃ¡c kÃ½ tá»± lÃ  giÃ¡ tiá»n cá»§a má»™t sáº£n pháº©m nÃ o Ä‘Ã³ Ä‘Æ°á»£c giá»›i thiá»‡u trong bÃ i Ä‘Äƒng.

## PhÃ¢n tÃ­ch wordcloud
```{r}
wordcloud(names(term_freq), term_freq, scale = c(4, 0.5), max.words = 100, random.order = FALSE, colors = brewer.pal(8, "Dark2"))
```
## Insight
Sau khi phÃ¢n tÃ­ch wordcloud, nhÃ³m nháº­n tháº¥y Ä‘Æ°á»£c cÃ¡c tá»« liÃªn quan Ä‘áº¿n mÃ³n Äƒn nhÆ° lÃ  'gÃ ', 'khoai tÃ¢y', 'burger' Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u, cÃ¡c tá»« liÃªn quan Ä‘áº¿n chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i nhÆ° 'combo', 'Ã¡p - dá»¥ng' cÅ©ng Ä‘Æ°á»£c dÃ¹ng khÃ¡ lÃ  nhiá»u. Äiá»u nÃ y cho tháº¥y ráº±ng Lotteria thÆ°á»ng xuyÃªn Ä‘Äƒng bÃ i vá» cÃ¡c deals, khuyáº¿n mÃ£i, giá»›i thiá»‡u sáº£n pháº©m má»›i Ä‘á»ƒ tÄƒng doanh thu.

## PhÃ¢n tÃ­ch thá»ƒ loáº¡i bÃ i Ä‘Äƒng theo nÄƒm
```{r}
# Aggregate data by year and status, counting the number of posts
yearly_status_counts <- fanpost %>%
  group_by(Year, status) %>%
  summarise(count = n(), .groups = 'drop')

# Calculate the total posts per year
yearly_totals <- yearly_status_counts %>%
  group_by(Year) %>%
  summarise(total = sum(count))

# Join the totals back to the original aggregated data
yearly_status_percentages <- yearly_status_counts %>%
  left_join(yearly_totals, by = "Year") %>%
  mutate(percentage = (count / total) * 100)

# Plot the data, showing the percentage of each status per year
# Plot with annotations
# Base plot
p <- ggplot(yearly_status_percentages, aes(x = Year, y = percentage)) +
  geom_bar(aes(fill = status), stat = "identity", position = "fill") + # Stacked percentage bars
  geom_text(aes(label = count, group = status), position = position_fill(vjust = 0.5), size = 3, color = "white") + # Add count annotations within bars
  scale_y_continuous(labels = percent_format()) + # Format y-axis as percentage
  labs(title = "Post Statuses Over Time",
       x = "Year",
       y = "Percentage",
       fill = "Status") +
  theme_minimal()

# Add total posts annotations at the top
p <- p + geom_text(data = yearly_totals, aes(x = Year, label = total), y = 100, vjust = 0, size = 3, color = 'red')

# Display the plot
print(p)
```

## Insight
Theo xu hÆ°á»›ng á»Ÿ trÃªn, cá»¥m neutral cÅ©ng theo xu hÆ°á»›ng nhÆ° tháº¿ vá»›i sá»‘ lÆ°á»£ng cao vÃ o nÄƒm 2012, tháº¥p hoáº·c gáº§n nhÆ° khÃ´ng cÃ³ vÃ o cÃ¡c nÄƒm tiáº¿p theo, vÃ  á»•n Ä‘á»‹nh vÃ o nÄƒm 2016 trá»Ÿ Ä‘i. Káº¿t quáº£ trÃªn thá»ƒ hiá»‡n ráº±ng tuy cÃ³ sá»± thay Ä‘á»•i trong sá»‘ lÆ°á»£ng bÃ i Ä‘Äƒng nhÆ°ng tá»· lá»‡ cÃ¡c loáº¡i bÃ i Ä‘Äƒng khÃ¡ lÃ  Ä‘á»u vá»›i tá»· lá»‡ bÃ i Ä‘Äƒng kÃ¨m áº£nh chiáº¿m Ä‘a sá»‘ trá»« trÆ°á»ng há»£p vÃ o 2012, 2013. Äiá»u nÃ y cho tháº¥y ráº±ng xu hÆ°á»›ng cÃ¡c bÃ i Ä‘Äƒng váº«n giá»¯ á»•n Ä‘á»‹nh qua cÃ¡c thá»i ká»³.

## PhÃ¢n tÃ­ch Ä‘iá»ƒm tÆ°Æ¡ng tÃ¡c vÃ  thá»ƒ loáº¡i bÃ i Ä‘Äƒng

```{r}
# Filter fanpost to include only entries from 2016 and beyond
fanpost_filtered <- fanpost %>% 
  filter(Year >= 2016)

status_scores_yearly <- fanpost_filtered %>%
  group_by(Year, status) %>%
  summarise(average_react_score = mean(react_score, na.rm = TRUE),
            average_comment_score = mean(comment_score, na.rm = TRUE),
            .groups = 'drop')

ggplot(status_scores_yearly, aes(x = Year, y = average_react_score, color = status, group = status)) +
  geom_line() +
  geom_point() +
  labs(title = "Average React Score by Status Over Time",
       x = "Year",
       y = "Average React Score",
       color = "Status") +
  theme_minimal()

ggplot(status_scores_yearly, aes(x = Year, y = average_comment_score, color = status, group = status)) +
  geom_line() +
  geom_point() +
  labs(title = "Average Comment Score by Status Over Time",
       x = "Year",
       y = "Average Comment Score",
       color = "Status") +
  theme_minimal()
```


## Insight
Khi nhÃ¬n káº¿t quáº£, cÃ³ thá»ƒ tháº¥y Ä‘Æ°á»£c cÃ¡c Ä‘iá»ƒm tÆ°Æ¡ng tÃ¡c vÃ  comment khÃ¡ á»•n Ä‘á»‹nh ngoáº¡i trá»« má»™t sá»‘ outlier lÃ m biáº¿n Ä‘á»•i sá»‘ lÆ°á»£ng. NhÃ¬n chung thÃ¬ tháº¥y Ä‘Æ°á»£c loáº¡i bÃ i cÃ³ hÃ¬nh áº£nh vÃ  video nháº­n Ä‘Æ°á»£c sá»± tÆ°Æ¡ng tÃ¡c trung bÃ¬nh cao hÆ¡n vÃ  cÃ³ Ä‘á»™ á»•n Ä‘á»‹nh hÆ¡n

## PhÃ¢n tÃ­ch tá»« phá»• biáº¿n theo thá»i gian
```{r, warning=FALSE}
term_freq <- rowSums(as.matrix(neutralTDM))
top_keywords <- head(sort(term_freq, decreasing = TRUE), 20)
# Láº¥y danh sÃ¡ch cÃ¡c tá»« khÃ³a
keywords <- names(top_keywords)

# Táº¡o ma tráº­n chá»©a thÃ´ng tin vá» sá»± xuáº¥t hiá»‡n cá»§a tá»«ng tá»« khÃ³a trong má»—i bÃ i viáº¿t
keyword_matrix <- sapply(keywords, function(keyword) grepl(keyword, neutral$new_message, ignore.case = TRUE))

# TÃ­nh ma tráº­n tÆ°Æ¡ng quan giá»¯a cÃ¡c tá»« khÃ³a
correlation_matrix <- cor(keyword_matrix)

# Váº½ biá»ƒu Ä‘á»“ nhiá»‡t tÆ°Æ¡ng quan
heatmap(correlation_matrix, 
        col = colorRampPalette(c("white", "blue"))(20),
        main = "Heatmap of correlation for neutral post words")

# Váº½ biá»ƒu Ä‘á»“ máº¡ng cÃ¡c tá»« khÃ³a cÃ³ giÃ¡ trá»‹ tÆ°Æ¡ng quan hÆ¡n 0.5
keyword_network <- graph.adjacency(correlation_matrix > 0.5, mode = "undirected")
plot(keyword_network, main = "Network diagram for Neutral post words")
```
#Cá»¥m Negative
```{r}
head(negative)
nrow(negative)
```
Cá»¥m Negative chá»©a tá»•ng cá»™ng 1285 dÃ²ng. VÃ¬ Ä‘Ã¢y lÃ  cá»¥m cÃ³ tá»•ng Ä‘iá»ƒm tÆ°Æ¡ng tÃ¡c (react_score) tháº¥p nháº¥t, tá»©c kháº£ nÄƒng cao Ä‘Ã¢y lÃ  cá»¥m chá»©a nhá»¯ng bÃ i Ä‘Äƒng cÃ³ ná»™i dung tiÃªu cá»±c nÃªn má»›i nháº­n láº¡i nhá»¯ng pháº£n á»©ng nhÆ° sad, angry (mang dáº¥u Ã¢m trong cÃ´ng thá»©c tÃ­nh Ä‘iá»ƒm). Tuy nhiÃªn Ä‘Ã¢y má»›i lÃ  suy Ä‘oÃ¡n ban Ä‘áº§u nÃªn nhÃ³m sáº½ tiáº¿n hÃ nh phÃ¢n tÃ­ch Ä‘áº·c Ä‘iá»ƒm cÃ¡c  bÃ i Ä‘Äƒng cá»§a cá»¥m nÃ y Ä‘á»ƒ hiá»ƒu rÃµ lÃ½ do tháº­t sá»± dáº«n Ä‘áº¿n tá»•ng Ä‘iá»ƒm tÆ°Æ¡ng tÃ¡c tháº¥p.
```{r, warning = FALSE}
# Táº¡o corpus cho cá»¥m positive
NegativeMessage <- negative$new_message
NegativeCorpus <- Corpus(VectorSource(negativeMessage))
```

```{r}
# ThÃªm metadata
meta(NegativeCorpus, tag = "id") <- negative$post_id
meta(NegativeCorpus, tag = "create_Year") <- negative$Year
meta(NegativeCorpus, tag = "status") <- negative$status
meta(NegativeCorpus, tag = "React_score") <- negative$react_score
meta(NegativeCorpus, tag = "comment_score") <- negative$comment_score

# Transform dá»¯ liá»‡u
NegativeCorpus <- tm_map(NegativeCorpus, content_transformer(tolower)) # Viáº¿t thÆ°á»ng
NegativeCorpus <- tm_map(NegativeCorpus, removePunctuation) # Bá» dáº¥u
NegativeCorpus <- tm_map(NegativeCorpus, removeNumbers) # Bá» nhá»¯ng con sá»‘
NegativeCorpus <- tm_map(NegativeCorpus, removeWords, stopwords) # Bá» stopwords
NegativeCorpus <- tm_map(NegativeCorpus, stripWhitespace) # Bá» khoáº£ng tráº¯ng
NegativeCorpus <- tm_map(NegativeCorpus, stemDocument) # Stemming
```



### Táº¡o TDM
```{r, warning=FALSE}
# Create the Term Document Matrix
negativeTDM <- TermDocumentMatrix(neutralCorpus, control = list(wordLengths = c(1, Inf)))
negativeTDM <- removeSparseTerms(negativeTDM, 0.9)

# Examine the TDM
inspect(negativeTDM)
```

# Wordcloud so sÃ¡nh cÃ¡c tá»« xuáº¥t hiá»‡n thÆ°á»ng xuyÃªn cá»§a 3 cá»¥m

```{r}
# Táº¡o wordcloud cho negative
wordcloudNegative<-wordcloud( NegativeCorpus,min.freq = 10,colors = brewer.pal(9, "Blues"), random.order = F)
title1 <- grid::textGrob("Negative Words", gp = grid::gpar(fontsize = 14, fontface = "bold", col = "blue"))

# Táº¡o wordcloud cho positive
wordcloudPositive<-wordcloud(positiveCorpus,min.freq = 10,colors = brewer.pal(9, "Greens"), random.order = F)
title2 <- grid::textGrob("Positive Words", gp = grid::gpar(fontsize = 14, fontface = "bold", col = "green"))

# Táº¡o wordcloud cho neutral
wordcloudNeutral<-wordcloud(neutralCorpus,min.freq = 10,colors = brewer.pal(9, "Reds"), random.order = F)
title3 <- grid::textGrob("Neutral Words", gp = grid::gpar(fontsize = 14, fontface = "bold", col = "red"))

```
Cáº£ 3 wordcloud cá»§a 3 cá»¥m Positive, Negative, Neutral Ä‘á»u cho tháº¥y nhá»¯ng tá»« tÆ°Æ¡ng tá»± nhau nhÆ° â€œhÃ ngâ€, â€œgÃ â€, â€œtrÃ¬nhâ€,â€¦ Váº­y Ä‘iá»u gÃ¬ Ä‘Ã£ dáº«n tá»›i sá»± khÃ¡c biá»‡t trong sá»‘ Ä‘iá»ƒm tÆ°Æ¡ng tÃ¡c cá»§a 3 cá»¥m, vÃ  Ä‘áº·c Ä‘iá»ƒm nÃ o cá»§a ná»™i dung bÃ i Ä‘Äƒng Ä‘Ã£ lÃ m cho cá»¥m Negative cÃ³ sá»‘ Ä‘iá»ƒm tháº¥p nháº¥t?
 NhÃ³m sáº½ báº¯t Ä‘áº§u báº±ng viá»‡c phÃ¢n tÃ­ch sá»‘ lÆ°á»£ng thÃ nh pháº§n cÃ¡c loáº¡i react mÃ  bÃ i Ä‘Äƒng trong cá»¥m nÃ y nháº­n Ä‘Æ°á»£c.

```{r}
#Váº½ Ä‘á»“ thá»‹ tÃ­nh tá»•ng react positive vÃ  negative  cá»§a cá»¥m Negative
sum_positive_react <- negative$like + negative$love + negative$haha + negative$wow +  negative$thankful +  negative$pride +  negative$care
sum_negative_react <- negative$sad + negative$angry
sum_positive_react  <- sum(sum_positive_react)
sum_negative_react <- sum(sum_negative_react)
total_react <- c(sum_positive_react,sum_negative_react)
colnames(total_react) <- c("Positive react", "Negative react")
lbls <- c("Positive react", "Positive react")
barplot(total_react, names.arg = lbls, main="Bar Chart of React",  ylab = "Total React",  xlab = "Column Names")
```
Äá»“ thá»‹ trÃªn cho tháº¥y rÃµ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c tiÃªu cá»±c ráº¥t Ã­t cÃ³ thá»ƒ nÃ³i lÃ  khÃ´ng Ä‘Ã¡ng ká»ƒ so vá»›i lÆ°á»£ng tÆ°Æ¡ng tÃ¡c tÃ­ch cá»±c. Tá»« Ä‘Ã¢y, cÃ³ thá»ƒ káº¿t luáº­n ráº±ng cÃ¡c cÃ¡c  bÃ i Ä‘Äƒng náº±m trong cá»¥m nÃ y cÃ³ Ä‘iá»ƒm tá»•ng Ä‘iá»ƒm tháº¥p lÃ  do cÃ³ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c tháº¥p, khÃ´ng Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng Ä‘Ã³n nháº­n, quan tÃ¢m nhiá»u. 
Sau Ä‘Ã¢y, nhÃ³m sáº½ phÃ¢n tÃ­ch ká»¹ hÆ¡n vÃ o ná»™i dung cá»§a cÃ¡c bÃ i Ä‘Äƒng trong cá»¥m nÃ y.
```{r}
#Chuyá»ƒn negative thÃ nh Corpus
NegativeCorpus <- Corpus(VectorSource(negative$new_message))
# Táº¡o Term Document matrix
negativeTDM <- TermDocumentMatrix(NegativeCorpus, control = list(wordLenghts=c(1,Inf)))
inspect(negativeTDM)
# TÃ¬m sá»‘ láº§n xuáº¥t hiá»‡n cá»§a tá»«ng tá»«
freqNegative <- rowSums(as.matrix(negativeTDM))
# TÃ­nh sá»‘ tá»« tÆ°Æ¡ng á»©ng vá»›i 2% lá»›n nháº¥t
top_2_percent <- length(freqNegative) * 0.02
# Sáº¯p xáº¿p vÃ  láº¥y 2% tá»« xuáº¥t hiá»‡n nhiá»u nháº¥t
top_words <- head(sort(freqNegative, decreasing = TRUE), n = top_2_percent)
# In ra danh sÃ¡ch cÃ¡c tá»« xuáº¥t hiá»‡n nhiá»u nháº¥t
print(top_words)
```
Tiáº¿p theo, nhÃ³m sáº½ tÃ¬m nhá»¯ng tá»« cÃ³ kháº£ nÄƒng cao xuáº¥t hiá»‡n cÃ¹ng vá»›i 5 tá»« cÃ³ lÆ°á»£t xuáº¥t hiá»‡n cao nháº¥t Ä‘á»ƒ biáº¿t Ä‘Æ°á»£c nhá»¯ng ná»™i dung phá»• biáº¿n trong cá»¥m bÃ i Ä‘Äƒng nÃ y.
```{r}
#TÃ¬m nhá»¯ng tá»« liÃªn quan
findAssocs(negativeTDM, 'hÃ ng',.5)
findAssocs(negativeTDM, 'giáº£i',.5)
findAssocs(negativeTDM, 'gÃ ',.5)
findAssocs(negativeTDM, 'táº·ng',.5)
findAssocs(negativeTDM, 'vui',.4)
```
Tá»« káº¿t quáº£ trÃªn nhÃ³m cÃ³ thá»ƒ ghÃ©p ra Ä‘Æ°á»£c nhá»¯ng cá»¥m tá»« cÃ¹ng chá»§ Ä‘á» thÆ°á»ng xuyÃªn xuáº¥t hiá»‡n cÃ¹ng nhau vá»›i táº§n suáº¥t cao vÃ  suy Ä‘oÃ¡n Ä‘Æ°á»£c nhá»¯ng chá»§ Ä‘á» cá»§a cÃ¡c bÃ i Ä‘Äƒng nÃ y: 
+ HÃ ng: táº·ng, giao, dá»‹ch , tÃ­ch, ğŸ’Ÿdanh,ğŸ’Ÿmember
ïƒ¨	Chá»§ Ä‘á» liÃªn quan: cÃ¡c chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i, Æ°u Ä‘Ã£i, vÃ  cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n viá»‡c táº·ng quÃ , giao hÃ ng, giao dá»‹ch, tÃ­ch Ä‘iá»ƒm, Ä‘Äƒng kÃ½ thÃ nh viÃªn, hoáº·c cÃ¡c thÃ´ng tin vá» danh sÃ¡ch thÃ nh viÃªn.
+ Giáº£i: khÃ­ch, nhÃ¬, thÆ°á»Ÿng, cáº¥u, marketingvn
ïƒ¨	Chá»§ Ä‘á» liÃªn quan: cÃ´ng bá»‘ káº¿t quáº£ cÃ¡c minigame, cÃ¡c sá»± kiá»‡n thÆ°á»Ÿng dÃ nh cho khÃ¡ch hÃ ng, thÃ´ng bÃ¡o cÆ¡ cáº¥u giáº£i thÆ°á»Ÿng cÃ¡c cuá»™c thi nháº±m marketing cho Lotteria
+ GÃ : chiÃªn, pepsi, miáº¿ng, khoai, tÃ¢y, teriyaki, fish, package,ğŸ‰funny,ğŸ‰happy,ğŸ‰lucky,ğŸ‰sinh, thiá»‡p, Ä‘Ã¹iÂ¸ nÃ³n, nháº­t, Ã´m, burger, nugget           gÃ³i, khá»•ng, lá»“, tiá»‡c, thá»a, gá»‘i.
ïƒ¨	Chá»§ Ä‘á» liÃªn quan: giá»›i thiá»‡u cÃ¡c combo gá»“m cÃ¡c mÃ³n bÃ¡n cháº¡y nhÆ° gÃ  chiÃªn, gÃ  nugget, burger gÃ , gÃ  teriyaki, thÃ´ng bÃ¡o vá» cÃ¡c sá»± kiá»‡n, tiá»‡c tÃ¹ng, sinh nháº­t, mÃ  mÃ  khÃ¡ch hÃ ng cÃ³ thá»ƒ tá»• chá»©c táº¡i Lotteria.
+ Táº·ng: ğŸ’Ÿdanh,ğŸ’Ÿmember, ğŸ’Ÿday, máº¯n, may, tÃ­ch, lpoint, Ä‘á»£t
ïƒ¨	Chá»§ Ä‘á» liÃªn quan: cÃ¡c chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i, Æ°u Ä‘Ã£i, vÃ  cÃ¡c sá»± kiá»‡n Ä‘áº·c biá»‡t dÃ nh riÃªng cho thÃ nh viÃªn cá»§a Lotteria vÃ o nhá»¯ng ngÃ y Ä‘áº·c biá»‡t hoáº·c cÃ¡c Ä‘á»£t khuyáº¿n mÃ£i lá»›n nhÆ° mÃ¹a lá»… há»™i Noel,â€¦
+ Vui: nhá»™n, tiá»‡c, sinh, trÃ², bÃ©, thiá»‡p, nÃ³n
ïƒ¨	Chá»§ Ä‘á» liÃªn quan: thÃ´ng bÃ¡o cÃ¡c sá»± kiá»‡n, hoáº¡t Ä‘á»™ng vui chÆ¡i, táº·ng quÃ  khuyáº¿n mÃ£i Ã¡p dá»¥ng dÃ nh riÃªng cho tráº» em táº¡i Lotteria.
Dá»±a vÃ o cÃ¡c cá»¥m tá»« xuáº¥t hiá»‡n thÆ°á»ng xuyÃªn, chÃºng ta cÃ³ Ä‘Æ°á»£c cÃ¡i nhÃ¬n tá»•ng quan vá» ná»™i dung phá»• biáº¿n cá»§a cÃ¡c bÃ i Ä‘Äƒng trong cá»¥m Negative. Chá»§ yáº¿u lÃ  cÃ¡c thÃ´ng bÃ¡o vá» hoáº¡t Ä‘á»™ng má»›i, sá»± kiá»‡n, giá»›i thiá»‡u cÃ¡c chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i nhÆ° combo, Æ°u Ä‘Ã£i cho thÃ nh viÃªn tÃ­ch Ä‘iá»ƒm vÃ  thÃ´ng bÃ¡o káº¿t quáº£ cá»§a cÃ¡c cuá»™c thi, minigame.
Tuy nhiÃªn, cÃ¡c chá»§ Ä‘á» nÃ y thÆ°á»ng khÃ´ng cÃ³ Ä‘iá»ƒm Ä‘áº·c biá»‡t Ä‘á»§ Ä‘á»ƒ thu hÃºt sá»± chÃº Ã½ cá»§a ngÆ°á»i dÃ¹ng. Trong cÃ¡c bÃ i Ä‘Äƒng, thÆ°á»ng khÃ´ng cÃ³ lá»i kÃªu gá»i hÃ nh Ä‘á»™ng (Call-to-action) cÅ©ng nhÆ° pháº§n thÆ°á»Ÿng kÃ¨m theo. Do Ä‘Ã³, thÃ´ng thÆ°á»ng nhá»¯ng chá»§ Ä‘á» nÃ y sáº½ khÃ´ng nháº­n Ä‘Æ°á»£c nhiá»u sá»± tÆ°Æ¡ng tÃ¡c tá»« phÃ­a ngÆ°á»i dÃ¹ng.
```{r}
# Váº½ biá»ƒu Ä‘á»“ hiá»ƒn thá»‹ giá» Ä‘Äƒng cá»§a cÃ¡c bÃ i
negative$Hour <- as.POSIXct(negative$Hour, format = "%H")
ggplot(negative, aes(x = Hour)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black") +
  labs(title = "Giá» ÄÄƒng BÃ i",
       x = "Giá» ÄÄƒng",
       y = "Sá»‘ LÆ°á»£ng BÃ i ÄÄƒng") +
  theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
```
Biá»ƒu Ä‘á»“ trÃªn cho tháº¥y cÃ¡c bÃ i Ä‘Äƒng trong cá»¥m Negative chá»§ yáº¿u Ä‘Æ°á»£c Ä‘Äƒng táº£i trong khoáº£ng thá»i gian tá»« 8h â€“ 11h vÃ  tá»« 14 â€“ 17h. Äiá»ƒm chung lÃ  cáº£ hai khung giá» nÃ y Ä‘á»u náº±m trong giá» hÃ nh chÃ­nh, lÃ  khoáº£ng thá»i gian Ä‘a sá»‘ má»i ngÆ°á»i Ä‘á»u Ä‘i há»c vÃ  Ä‘i lÃ m, khÃ´ng cÃ³ thá»i gian lÆ°á»›t máº¡ng xÃ£ há»™i. ÄÄƒng bÃ i truyá»n thÃ´ng trong khoáº£ng thá»i gian nÃ y sáº½ khÃ´ng cÃ³ nhiá»u ngÆ°á»i xem, do Ä‘Ã³, Ä‘Ã¢y ráº¥t cÃ³ thá»ƒ lÃ  nguyÃªn nhÃ¢n dáº«n Ä‘áº¿n lÆ°á»£t tÆ°Æ¡ng tÃ¡c tháº¥p cá»§a cÃ¡c bÃ i Ä‘Äƒng náº±m trong cá»¥m nÃ y.
#Káº¿t luáº­n
Ban Ä‘áº§u nhÃ³m ghi nháº­n Ä‘Ã¢y lÃ  cá»¥m Negative tá»©c lÃ  cá»¥m gá»“m nhá»¯ng bÃ i Ä‘Äƒng nghi ngá» cÃ³ tÃ­nh cháº¥t hoáº·c chá»©a tá»« ngá»¯ cÃ³ tÃ­nh cháº¥t tiÃªu cá»±c do Ä‘iá»ƒm tÆ°Æ¡ng tÃ¡c (react_score) cá»§a cá»¥m lÃ  tháº¥p nháº¥t. Tuy nhiÃªn, qua quÃ¡ trÃ¬nh phÃ¢n tÃ­ch vÃ  so sÃ¡nh cÃ¡c tá»« phá»• biáº¿n cá»§a cá»¥m vá»›i 2 cá»¥m Positive vÃ  Neutral khÃ´ng nháº­n tháº¥y cÃ³ Ä‘iá»ƒm gÃ¬ báº¥t thÆ°á»ng, cÅ©ng nhÆ° sá»‘ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c tiÃªu cá»±c tá»« ngÆ°á»i dÃ¹ng chiáº¿m ráº¥t Ã­t trong tá»•ng lÆ°á»£ng tÆ°Æ¡ng tÃ¡c. 
CÃ³ thá»ƒ káº¿t luáº­n ráº±ng cÃ¡c bÃ i Ä‘Äƒng náº±m trong cá»¥m Negative khÃ´ng cÃ³ tÃ­nh cháº¥t tiÃªu cá»±c hoáº·c gÃ¢y tranh cÃ£i, Ä‘Ã¢y chá»‰ Ä‘Æ¡n thuáº§n lÃ  nhá»¯ng bÃ i cÃ³ ná»™i dung chá»§ Ä‘á» khÃ´ng Ä‘á»§ thu hÃºt ngÆ°á»i dÃ¹ng vÃ  Ä‘Æ°á»£c Ä‘Äƒng vÃ o nhá»¯ng khung giá» náº±m trong giá» hÃ nh chÃ­nh nÃªn má»›i cÃ³ lÆ°á»£t tÆ°Æ¡ng tÃ¡c tháº¥p.

## Káº¿t luáº­n
6. Insight vÃ  Káº¿t Luáº­n:
Tá»« nhá»¯ng phÃ¢n tÃ­ch trÃªn, nhÃ³m rÃºt ra má»™t sá»‘ káº¿t luáº­n nhÆ° sau:
Giai Ä‘oáº¡n tá»« nÄƒm 2012 - 2016, lÆ°á»£ng bÃ i viáº¿t Ä‘Äƒng táº£i tuy nhiá»u nhÆ°ng lÆ°á»£ng tÆ°Æ¡ng tÃ¡c láº¡i tháº¥p, cÃ³ thá»ƒ liÃªn há»‡ nguyÃªn do thá»±c táº¿ lÃ  do sá»‘ lÆ°á»£ng ngÆ°á»i dÃ¹ng máº¡ng xÃ£ há»™i cÃ²n Ã­t vÃ  ngÆ°á»i dÃ¹ng cÃ²n Ã­t quan tÃ¢m vá» cÃ¡c bÃ i viáº¿t quáº£ng cÃ¡o trÃªn facebook.
Giai Ä‘oáº¡n tá»« nÄƒm 2016 - 2022, lÆ°á»£ng tÆ°Æ¡ng tÃ¡c cá»§a fanpage tÄƒng Ä‘Ã¡ng ká»ƒ, dÃ¹ sá»‘ bÃ i Ä‘Äƒng khÃ´ng tÄƒng vÃ  tháº­m chÃ­ Ã­t hÆ¡n giai Ä‘oáº¡n trÆ°á»›c. CÃ³ thá»ƒ tháº¥y tá»« nÄƒm 2016, fanpage cá»§a Lotteria Ä‘Ã£ phÃ¡t triá»ƒn hÆ¡n.

Dá»±a vÃ o pháº§n phÃ¢n tÃ­ch 3 cá»¥m positive, neagative vÃ  neutral, cÃ³ thá»ƒ tháº¥y má»™t sá»‘ Ä‘áº·c Ä‘iá»ƒm tá»« cÃ¡c bÃ i Ä‘Äƒng cá»§a Lotteria nhÆ°:
DÃ¹ng nhiá»u tá»« liÃªn quan tá»›i Ä‘á»™ nháº­n diá»‡n thÆ°Æ¡ng hiá»‡u: Lotteria, Lotteriavietnam, gÃ  rÃ¡n, cá»­a hÃ ng, pepsi, khoai tÃ¢y, giao hÃ ng,... 

Vá» chá»§ Ä‘á», cÃ¡c chá»§ Ä‘á» thÆ°á»ng Ä‘Æ°á»£c quan tÃ¢m nhiá»u lÃ  ChÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i vÃ  cÃ¡c cuá»™c thi. CÃ¡c tá»« khÃ³a Ä‘i kÃ¨m lÃ : combo, khuyáº¿n mÃ£i, chÆ°Æ¡ng trÃ¬nh,... CÃ³ thá»ƒ tháº¥y ngÆ°á»i dÃ¹ng quan tÃ¢m nhiá»u tá»›i cÃ¡c phÃºc lá»£i tá»« cÃ¡c chÆ°Æ¡ng trÃ¬nh giáº£m giÃ¡, cÃ²n vá» chá»§ Ä‘á» cÃ¡c cuá»™c thi cÃ³ thá»ƒ dá»± Ä‘oÃ¡n nguyÃªn do lÃ  nhá»¯ng pháº§n thÆ°á»Ÿng háº¥p dáº«n vÃ  nhá»¯ng yÃªu cáº§u trong cuá»™c thi thÆ°á»ng lÃ  báº¯t buá»™c ngÆ°á»i tham giÃ¡ cÃ¡c bÆ°á»›c nhÆ° like, share, comment nÃªn cÃ³ tÆ°Æ¡ng tÃ¡c cao hÆ¡n. NgÆ°á»£c láº¡i, cÃ¡c chá»§ Ä‘á» Ã­t Ä‘Æ°á»£c quan tÃ¢m thÆ°á»ng lÃ  cÃ¡c bÃ i viáº¿t thÃ´ng bÃ¡o nhÆ°: thÃ´ng bÃ¡o giáº£i thÆ°á»Ÿng cuá»™c thi, thÃ´ng bÃ¡o sá»± kiá»‡n, cÃ¡c hoáº¡t Ä‘á»™ng cho tráº» em. 

CÃ¡c khung giá» Ä‘Æ°á»£c tÆ°Æ¡ng tÃ¡c cao nháº¥t lÃ  tá»« 10 - 11 giá» sÃ¡ng, cÃ³ thá»ƒ dá»± Ä‘oÃ¡n do khung giá» nÃ y gáº§n tá»›i giá» Äƒn trÆ°a cá»§a há»c sinh viÃªn, dÃ¢n vÄƒn phÃ²ng nÃªn Ä‘Æ°á»£c tÆ°Æ¡ng tÃ¡c cao, lÃ  khung giá» phÃ¹ há»£p cho má»i ngÆ°á»i lá»±a chá»n vÃ  Ä‘áº·t Ä‘á»“ Äƒn. CÃ¡c cÃ¡c khung giá» khuya tá»« 19 giá» - 21 giá» thÆ°á»ng Ã­t Ä‘Æ°á»£c tÆ°Æ¡ng tÃ¡c vÃ¬ Ä‘Ã¢y lÃ  thá»i gian nghá»‰ ngÆ¡i cuá»‘i ngÃ y, vÃ  cÅ©ng dáº«n Ä‘áº¿n khung giá» hiáº¿m khi Ä‘Äƒng bÃ i trÃªn fanpage lÃ  tá»« 23 giá» Ä‘áº¿n 7 giá» sÃ¡ng. CÃ²n láº¡i cÃ¡c khung giá» khÃ¡c thÃ¬ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c á»Ÿ má»©c tÆ°Æ¡ng Ä‘á»‘i.

7. Äá» Xuáº¥t Chiáº¿n LÆ°á»£c Cho TÆ°Æ¡ng Lai
Dá»±a vÃ o nhá»¯ng káº¿t luáº­n trÃªn, nhÃ³m Ä‘Æ°a ra má»™t sá»‘ Ä‘á» xuáº¥t chiáº¿n lÆ°á»£c tá»‘i Æ°u hÃ³a vá» Ä‘á»™ phá»• biáº¿n vÃ  tÆ°Æ¡ng tÃ¡c nhÆ° Ä‘a dáº¡ng hÃ³a chá»§ Ä‘á» bÃ i viáº¿t nhÆ°:
-  NgoÃ i cÃ¡c bÃ i viáº¿t liÃªn quan trá»±c tiáº¿p tá»›i bÃ¡n hÃ ng nhÆ° giá»›i thiá»‡u menu, chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i,... thÃ¬ thÃªm cÃ¡c bÃ i viáº¿t nháº±m má»¥c Ä‘Ã­ch tÄƒng tÆ°Æ¡ng tÃ¡c vá»›i chá»§ Ä‘á» báº¯t trend Ä‘á»ƒ dá»… tiáº¿p cáº­n vÃ  háº¥p dáº«n ngÆ°á»i dÃ¹ng tráº» hÆ¡n. Táº¡o ra cÃ¡c loáº¡i ná»™i dung Ä‘a dáº¡ng nhÆ° video, hÃ¬nh áº£nh, bÃ i viáº¿t vÄƒn báº£n Ä‘á»ƒ phÃ¹ há»£p vá»›i sá»Ÿ thÃ­ch vÃ  thÃ³i quen tiÃªu dÃ¹ng cá»§a Ä‘á»‘i tÆ°á»£ng má»¥c tiÃªu.
- Láº­p káº¿ hoáº¡ch Ä‘Äƒng bÃ i viáº¿t vÃ o cÃ¡c khung giá» mÃ  ngÆ°á»i dÃ¹ng thÆ°á»ng online vÃ  hoáº¡t Ä‘á»™ng trÃªn máº¡ng xÃ£ há»™i, nhÆ° vÃ o giá» trÆ°a vÃ  buá»•i tá»‘i sau khi káº¿t thÃºc cÃ´ng viá»‡c: Ä‘Äƒng bÃ i vá» giá»›i thiá»‡u giáº£m giÃ¡, menu, giao hÃ ng,... vÃ o cÃ¡c khung giá» gáº§n bá»¯a Äƒn (10 - 11 giá» sÃ¡ng, 16 - 18 giá» tá»‘i), cÃ¡c bÃ i viáº¿t vá» giá»›i thiá»‡u sá»± kiá»‡n, cuá»™c thi vÃ o cÃ¡c giá» nghá»‰ ngÆ¡i vÃ  sau bá»¯a Äƒn (19 - 21 giá»), háº¡n cháº¿ Ä‘Äƒng bÃ i vÃ o khung giá» khuya (0 - 7 giá» sÃ¡ng). 
- Cáº£i thiá»‡n cÃ¡c ná»™i dung hÃ¬nh áº£nh, video Ä‘a dáº¡ng táº¡o ra cáº£m xÃºc kÃ­ch thÃ­ch tÆ°Æ¡ng tÃ¡c tá»« cá»™ng Ä‘á»“ng. ThÃºc Ä‘áº©y sá»± tham gia cá»§a ngÆ°á»i dÃ¹ng báº±ng cÃ¡ch tá»• chá»©c cÃ¡c cuá»™c thi, trÃ² chÆ¡i hoáº·c thÄƒm dÃ² Ã½ kiáº¿n Ä‘á»ƒ táº¡o ra mÃ´i trÆ°á»ng nÄƒng Ä‘á»™ng vÃ  thÃº vá»‹.